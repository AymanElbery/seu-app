<div class="main-content">
    <section class="service-single">
      <div class="container">
        <h3>{{ "menu.student_attendance" | translate}}</h3>
        <div class="row">
          <div class=" col-md-5">
            <p>{{"attends.attend_report"|translate}}</p>
          </div>
        </div>
      </div>
    </section>
    <div *ngIf="isLoading" class=" loading-indicator  ">
      <div class="state">
        <mat-spinner style="position: absolute;z-index: 10000;; margin: auto; top: 0; right: 0;  bottom: 0;left: 0; width: 10px; height: 10px;">
        </mat-spinner>
      </div>
    </div>
    <div class="row" style="margin-top: 10px;">
      <div class="col-md-4">
        <button (click)="exportexcel()" type="button" class="btn btn-success"> {{"attends.excel"|translate}}  <i class="fas fa-file-excel"></i></button>
      </div>
    </div>
    <div class="widget" style="margin-top: 10px;">
      <div class="table-responsive" #epltable>
        <table class="table table-striped table-bordered" id="excel-table">
            <thead>
                <tr>
                    <th scope="col">{{"attends.std_id"|translate}}</th>
                    <th scope="col">{{"attends.std_name"|translate}}</th>
                    <th *ngFor="let date of resDates" scope="col"> {{ date.INSERT_DATE[0] }} {{ date.INSERT_DATE[1] }}</th>
                </tr>
              </thead>
            <tbody>
                <tr *ngFor="let row of result; let i = index;">
                    <td>{{ row.STD_ID }}</td>
                    <td>{{ row.FULL_NAME_AR }}</td>
                    <td *ngFor="let colDate of dates; let j = index">
                        <!-- <span class="text-success attend-mark" *ngIf="colDate.INSERT_DATE == row.INSERT_DATES[j]"><i class="fa fa-check-circle"></i></span>
                        <span class="text-danger attend-mark" *ngIf="colDate.INSERT_DATE != row.INSERT_DATES[j]"><i class="fa fa-times-circle"></i></span> -->

                        <span class="text-success attend-mark" *ngIf="colDate.INSERT_DATE == row.INSERT_DATES[j]">{{"attends.attend"|translate}}</span>
                        <span class="text-danger attend-mark" *ngIf="colDate.INSERT_DATE != row.INSERT_DATES[j]">{{"attends.absent"|translate}}</span>
                    </td>
                </tr>
            </tbody>
        </table>
      </div>
    </div>
  </div>
  